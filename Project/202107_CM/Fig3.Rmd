---
title: 'Fig3  frequency for Searching infomation'
author: "Hsieh M.H"
date: "2021/8/8"
output: html_document
---


也許我們對於source的調查，如果說我們調查台灣民眾的分數，我們應該要調整權重比如認為也許在media use裡面有提及 source、condition frequency motivation。


老匠認為，受訪者平常有哪些資訊管道的時候，我們也需要稍微透過簡單的調查，透過媒體來源做排序。來發現目前台灣的民眾他們認為，哪些的媒體管道其實更符合民生對於使用媒體的了解(那些最常用的資訊是大眾媒體會接受的。)



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(osfr)
```

### 下載原始資料映像檔

```{r echo=TRUE, message=FALSE, warning=FALSE}
## Download and load W1 rawdata from OSF
osf_retrieve_file("he2v7") %>%
  osf_download()
## Download and load W2 rawdata from OSF
osf_retrieve_file("ch68a") %>%
  osf_download() 
```

### 載入原始資料物件

```{r message=FALSE, warning=FALSE}
load(list.files(recursive = TRUE,full.names = TRUE,include.dirs = TRUE,pattern = "*.Rdata")[1])
load(list.files(recursive = TRUE,full.names = TRUE,include.dirs = TRUE,pattern = "*.Rdata")[2])
ls()
file.remove(list.files(recursive = TRUE,full.names = TRUE,include.dirs = TRUE,pattern = "*.Rdata"))
```

### Wave 1原始資料欄位說明清單

```{r}
items %>% rmarkdown::paged_table(options = list(rows.print = 20))
```

```
Q1: 第一波疫情資訊可信度評分 = Table 3
Q2~Q7: 參與者背景資訊調查
Q8~Q10: 媒體使用習慣調查 => Figure 2
Q12,Q14,Q15: 疫情資訊更新管道及頻率 => Table4, Figure 3, Table 5
Q16: Need for Cognition scale
Q17: Need for Cognitive Closure scale
```

### Wave 2 原始資料欄位說明清單

```{r}
tag_info %>% rmarkdown::paged_table(options = list(rows.print = 20))
```

```
W1_: 第一波疫情資訊可信度評分 => Table 7
W2_: 第二波疫情資訊可信度評分 => Table 7
Q1_: 疫情起源說法可信度重製分析
```


### Wave 1 正式分析資料

根據以下描述，篩選納入正式分析的資料：

"Five hundred and twenty-six respondents completed the Wave 1 survey via the Prolific.com platform. Sixteen respondents were excluded for spending too much time on the survey("Duration..in.seconds." -> "Q1T_Page.Submit"). Another nine respondents were excluded for failing the catch question("Q1_CATCH1")."

由於初次嘗試發現分組人數與論文不一致，聯絡論文第一作者Arnout Boot，得知16位被排除的參與者是根據完成"Knowledge Test"的秒數。

```{r message=FALSE, warning=FALSE}
## check the equality of two data sets
sum(data_factors$Q1T_Page.Submit != data_numeric$Q1T_Page.Submit)
## Boxplot for test duration
boxplot(data_numeric$Q1T_Page.Submit)

wave1_rawdata <- data_numeric %>% 
## exclude the participants who spent more than 999 seconds on the knowledge test
  filter(Q1T_Page.Submit < 999) %>%
## exclude the participants who failed the catch question
  filter(Q1_CATCH1 == 5) %>%
## ## exclude the participants who spent time on the knowledge test longer than 3.29 standardized time
  filter(scale(Q1T_Page.Submit)<3.29)
## How many participants' data are analyzed?
wave1_rawdata %>%
  summarise(N=n())
```


#重製Fig3
NCC

```{r}
#1 先求出每位參與者的題目Q17的總平均

 wave1_rawdata %>%
 Q17m <- sum("Q17_1"
             +"Q17_2R"
             +"Q17_3"
             +"Q17_4"
             +"Q17_5R"
             +"Q17_6"
             +"Q17_7R"
             +"Q17_8"
             +"Q17_9"
             +"Q17_10"
             +"Q17_11"
             +"Q17_12R"
             +"Q17_13R"
             +"Q17_14"
             +"Q17_15"
             +"Q17_16R"
             +"Q17_17"
             +"Q17_18LIE"
             +"Q17_19R"
             +"Q17_20R"
             +"Q17_21"
             +"Q17_22LIE"
             +"Q17_23R"
             +"Q17_24"
             +"Q17_25R"
             +"Q17_26"
             +"Q17_27"
             +"Q17_28R"
             +"Q17_29R"
             +"Q17_30"
             +"Q17_31"
             +"Q17_32"
             +"Q17_33"
             +"Q17_34"
             +"Q17_35"
             +"Q17_36R"
             +"Q17_37"
             +"Q17_38"
             +"Q17_39LIE"
             +"Q17_40R"
             +"Q17_41"
             +"Q17_42"
             +"Q17_43LIE"
             +"Q17_44"
             +"Q17_45"
             +"Q17_46LIE"
             +"Q17_47R")/15

```
  

```{r}
wave1_rawdata %>%
  select(ID,Q17_1:Q17_47R)
  pivot_longer(cols = starts_with("Q17_"), names_to = "Responseld_", values_to = "rating") %>%
  group_by(ID) %>%
  summarise(Responseld_1 = mean(rating == Q17m),
            Responseld_2 = mean(rating == Q17m),
            Responseld_3 = mean(rating == Q17m),
            Responseld_4 = mean(rating == Q17m),
            Responseld_5 = mean(rating == Q17m),
            Responseld_6 = mean(rating == Q17m),
            Responseld_7 = mean(rating == Q17m),
            Responseld_8 = mean(rating == Q17m),
            Responseld_9 = mean(rating == Q17m),
           Responseld_10 = mean(rating == Q17m),
           Responseld_10 = mean(rating == Q17m),
           Responseld_11 = mean(rating == Q17m),
           Responseld_12 = mean(rating == Q17m),
           Responseld_13 = mean(rating == Q17m),
           Responseld_14 = mean(rating == Q17m),
           Responseld_15 = mean(rating == Q17m),
           Responseld_16 = mean(rating == Q17m),
           Responseld_17 = mean(rating == Q17m),
           Responseld_18 = mean(rating == Q17m),
           Responseld_19 = mean(rating == Q17m),
           Responseld_20 = mean(rating == Q17m),
           Responseld_21 = mean(rating == Q17m),
           Responseld_22 = mean(rating == Q17m),
           Responseld_23 = mean(rating == Q17m),
           Responseld_24 = mean(rating == Q17m),
           Responseld_25 = mean(rating == Q17m),
           Responseld_26 = mean(rating == Q17m), 
           Responseld_27 = mean(rating == Q17m),
           Responseld_28 = mean(rating == Q17m), 
           Responseld_29 = mean(rating == Q17m), 
           Responseld_30 = mean(rating == Q17m), 
           Responseld_31 = mean(rating == Q17m),
           Responseld_32 = mean(rating == Q17m), 
           Responseld_33 = mean(rating == Q17m), 
           Responseld_34 = mean(rating == Q17m),
           Responseld_35 = mean(rating == Q17m),
           Responseld_36 = mean(rating == Q17m),
           Responseld_37 = mean(rating == Q17m),
           Responseld_38 = mean(rating == Q17m),
           Responseld_39 = mean(rating == Q17m),
           Responseld_40 = mean(rating == Q17m),
           Responseld_41 = mean(rating == Q17m),
           Responseld_42 = mean(rating == Q17m),
           Responseld_43 = mean(rating == Q17m),
           Responseld_44 = mean(rating == Q17m),
           Responseld_45 = mean(rating == Q17m),
           Responseld_46 = mean(rating == Q17m),
           Responseld_47 = mean(rating == Q17m),
           Responseld_48 = mean(rating == Q17m),
           Responseld_49 = mean(rating == Q17m),
           Responseld_50 = mean(rating == Q17m),
           Responseld_51 = mean(rating == Q17m),
           Responseld_52 = mean(rating == Q17m),
           Responseld_53 = mean(rating == Q17m),
           Responseld_54 = mean(rating == Q17m),
           Responseld_55 = mean(rating == Q17m),
           Responseld_56 = mean(rating == Q17m),
           Responseld_57 = mean(rating == Q17m),
           Responseld_58 = mean(rating == Q17m),
           Responseld_59 = mean(rating == Q17m),
           Responseld_60 = mean(rating == Q17m),
           Responseld_61 = mean(rating == Q17m),
           Responseld_62 = mean(rating == Q17m),
           Responseld_63 = mean(rating == Q17m),
           Responseld_64 = mean(rating == Q17m),
           Responseld_65 = mean(rating == Q17m),
           Responseld_66 = mean(rating == Q17m),
           Responseld_67 = mean(rating == Q17m),
           Responseld_68 = mean(rating == Q17m),
           Responseld_69 = mean(rating == Q17m),
           Responseld_70 = mean(rating == Q17m),
           Responseld_71 = mean(rating == Q17m),
           Responseld_72 = mean(rating == Q17m),
           Responseld_73 = mean(rating == Q17m),
           Responseld_74 = mean(rating == Q17m),
           Responseld_75 = mean(rating == Q17m),
           Responseld_76 = mean(rating == Q17m),
           Responseld_77 = mean(rating == Q17m),
           Responseld_78 = mean(rating == Q17m),
           Responseld_79 = mean(rating == Q17m),
           Responseld_80 = mean(rating == Q17m),
           Responseld_81 = mean(rating == Q17m),
           Responseld_82 = mean(rating == Q17m),
           Responseld_83 = mean(rating == Q17m),
           Responseld_84 = mean(rating == Q17m),
           Responseld_85 = mean(rating == Q17m),
           Responseld_86 = mean(rating == Q17m),
           Responseld_87 = mean(rating == Q17m),
           Responseld_88 = mean(rating == Q17m),
           Responseld_89 = mean(rating == Q17m),
           Responseld_90 = mean(rating == Q17m),
           Responseld_91 = mean(rating == Q17m),
           Responseld_92 = mean(rating == Q17m),
           Responseld_93 = mean(rating == Q17m),
           Responseld_94 = mean(rating == Q17m),
           Responseld_95 = mean(rating == Q17m),
           Responseld_96 = mean(rating == Q17m),
           Responseld_97 = mean(rating == Q17m),
           Responseld_98 = mean(rating == Q17m),
           Responseld_99 = mean(rating == Q17m),
           Responseld_100 = mean(rating == Q17m),
          
  pivot_longer(cols = starts_with("Responseld_"), names_to = "Options",values_to = "Percentage") %>%
  group_by(Options) %>%
  arrange(desc(Options))
``` 
    
```{r}
## 求出前4分位數，以及後四分衛數
#高NCC #(1+501)*0.75=376.5 (Q376+Q377)/2
```
  