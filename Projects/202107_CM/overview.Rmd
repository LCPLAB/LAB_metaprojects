---
title: "原始資料重製分析及問卷中文化建置"
date: "`r Sys.Date()`"
output: 
  html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(osfr)
```

## 中文化問卷建置資訊

[Psytoolkit問卷資料測試](Psytoolkit_data.html)

## 原始資料重製分析

[認知動機問卷重製分析](NC.html)


### 下載原始資料映像檔

```{r echo=TRUE, message=FALSE, warning=FALSE}
## Download and load W1 rawdata from OSF
osf_retrieve_file("he2v7") %>%
  osf_download()
## Download and load W2 rawdata from OSF
osf_retrieve_file("ch68a") %>%
  osf_download() 
```

### 載入原始資料物件

```{r message=FALSE, warning=FALSE}
load(list.files(recursive = TRUE,full.names = TRUE,include.dirs = TRUE,pattern = "*.Rdata")[1])
load(list.files(recursive = TRUE,full.names = TRUE,include.dirs = TRUE,pattern = "*.Rdata")[2])
ls()
file.remove(list.files(recursive = TRUE,full.names = TRUE,include.dirs = TRUE,pattern = "*.Rdata"))
```

### Wave 1原始資料欄位說明清單

```{r}
items %>% rmarkdown::paged_table(options = list(rows.print = 20))
```

### Wave 2 原始資料欄位說明清單

```{r}
tag_info %>% rmarkdown::paged_table(options = list(rows.print = 20))
```


### Wave 1 正式分析資料

根據以下描述，篩選納入正式分析的資料：

"Five hundred and twenty-six respondents completed the Wave 1 survey via the Prolific.com platform. Sixteen respondents were excluded for spending too much time on the survey("Duration..in.seconds."). Another nine respondents were excluded for failing the catch question("Q1_CATCH1")."

```{r message=FALSE, warning=FALSE}
## check the equality of two data sets
sum(data_factors$Duration..in.seconds. != data_numeric$Duration..in.seconds.)
## Boxplot for test duration
boxplot(data_numeric$Duration..in.seconds.)

wave1_rawdata <- data_numeric %>% 
## exclude the participants who spent longer duration than the 17th slowest participant
  filter(Duration..in.seconds. <= sort(data_numeric$Duration..in.seconds., decreasing = TRUE)[17]) %>%
## exclude the participants who failed the catch question
  filter(Q1_CATCH1 == 5) 
## How many participants' data are analyzed?
wave1_rawdata %>%
  summarise(n())
```

重製原始論文 Table 3描述統計

```{r}
## True statement "I am sure this is true"

## Approach 1, my favor
wave1_rawdata %>%
  select(ID,Q1_1:Q1_12) %>%
  pivot_longer(cols = starts_with("Q1_"), names_to = "True_statment", values_to = "rating") %>%
  group_by(ID) %>%
  summarise(Percentage_option5 = mean(rating == 5),
            Percentage_option4 = mean(rating == 4),
            Percentage_option3 = mean(rating == 3),
            Percentage_option2 = mean(rating == 2),
            Percentage_option1 = mean(rating == 1)) %>%
  pivot_longer(cols = starts_with("Percentage_"), names_to = "Options",values_to = "Averages") %>%
  group_by(Options) %>%
  summarise(Mean = round(mean(Averages)*100,2), 
            SD = round(sd(Averages)*100,2),
            CI_L = round(Mean + qnorm(.05)*SD/sqrt(length(unique(ID))),2),
            CI_U = round(Mean + qnorm(.95)*SD/sqrt(length(unique(ID))),2),
            MIN = min(Averages),
            MAX = max(Averages))


## Approach 2
wave1_rawdata %>%
  select(Q1_1:Q1_12) %>%
  summarise(Q1_1_5 = sum(Q1_1==5)/length(Q1_1),
            Q1_2_5 = sum(Q1_2==5)/length(Q1_2),
            Q1_3_5 = sum(Q1_3==5)/length(Q1_3),
            Q1_4_5 = sum(Q1_4==5)/length(Q1_4),
            Q1_5_5 = sum(Q1_5==5)/length(Q1_5),
            Q1_6_5 = sum(Q1_6==5)/length(Q1_6),
            Q1_7_5 = sum(Q1_7==5)/length(Q1_7),
            Q1_8_5 = sum(Q1_8==5)/length(Q1_8),
            Q1_9_5 = sum(Q1_9==5)/length(Q1_9),
            Q1_10_5 = sum(Q1_10==5)/length(Q1_10),
            Q1_11_5 = sum(Q1_11==5)/length(Q1_11),
            Q1_12_5 = sum(Q1_12==5)/length(Q1_12)) %>%
  pivot_longer(cols = starts_with("Q1_"),names_to = "True_Statement_5", values_to = "Percentage") %>%
  summarise(Average = round(mean(Percentage)*100), 
            SD = round(sd(Percentage)*100))

# unavailable code
#ture_statements <- wave1_rawdata  %>% 
#  mutate(year = year(date)) %>% 
#  group_by(year) %>% 
#  summarise( n = n(), 
#             mean_percentage = mean(total, na.rm = TRUE), 
#             SD = sd(total, na.rm = TRUE), 
#             Min = min(total, na.rm = TRUE), 
#             Max = max(total, na.rm = TRUE), 
#             .groups = "drop" )
```



### Media use code

```{r}
data.frame(TEXT = wave1_rawdata$Q10_1, CODE = wave1_rawdata$Q10_1) %>% distinct() %>% arrange(CODE)
data.frame(TEXT = wave1_rawdata$Q10_2, CODE = wave1_rawdata$Q10_2) %>% distinct() %>% arrange(CODE)

```
