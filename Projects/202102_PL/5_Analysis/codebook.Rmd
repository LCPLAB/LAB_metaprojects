---
title: "Codebook for Replication study of Kerwer et al.(2020)"
output:
  html_document:
    toc: true
    toc_depth: 4
    toc_float: true
    code_folding: 'hide'
    self_contained: true
  pdf_document:
    toc: yes
    toc_depth: 4
    latex_engine: xelatex
---

Here, we're just setting a few options.

```{r setup}
knitr::opts_chunk$set(
  warning = TRUE, # show warnings during codebook generation
  message = TRUE, # show messages during codebook generation
  error = TRUE, # do not interrupt codebook generation in case of errors,
                # usually better for debugging
  echo = TRUE  # show R code
)
ggplot2::theme_set(ggplot2::theme_bw())

```

Now, we're preparing our data for the codebook.

```{r prepare_codebook, message=FALSE, warning=FALSE}
library(codebook)
codebook_data <- codebook::bfi
# to import an SPSS file from the same folder uncomment and edit the line below
# codebook_data <- rio::import("mydata.sav")
# for Stata
# codebook_data <- rio::import("mydata.dta")
# for CSV

## locate the rawdata file
zip_path <- list.files(path = "..",pattern = "jatos_results.zip",include.dirs = TRUE,recursive = TRUE,full.names = TRUE)
## import rawdata from zip file
df <- readr::read_csv(unz(zip_path, filename = "rawdata.csv"))

## Split basic data
df_Basic <- dplyr::filter(df, Q_type == "Basic")

## Split Belief data
df_Belief <- dplyr::filter(df, Q_type == "Belief")

## Split self evaluation data
df_self_eval <- dplyr::filter(df, Q_type == "self_eval")

## Split post reading Question data
df_Post <- dplyr::filter(df, Q_type == "Post_survey")

## Split knowledge data
df_knowledge <- dplyr::filter(df, Q_type == "Knowledge")

## Split Exit
df_Exit <- dplyr::filter(df, Q_type == "Exit")


# omit the following lines, if your missing values are already properly labelled
#codebook_data <- detect_missing( df, #codebook_data,
#    only_labelled = TRUE, # only labelled values are autodetected as
                                   # missing
#    negative_values_are_missing = FALSE, # negative values are missing values
#    ninety_nine_problems = TRUE,   # 99/999 are missing values, if they
                                   # are more than 5 MAD from the median
#    )

# If you are not using formr, the codebook package needs to guess which items
# form a scale. The following line finds item aggregates with names like this:
# scale = scale_1 + scale_2R + scale_3R
# identifying these aggregates allows the codebook function to
# automatically compute reliabilities.
# However, it will not reverse items automatically.
#codebook_data <- detect_scales(df)
```

Manage the variable labels and scales

```{r variables, message=FALSE, warning=FALSE}
library(labelled)
#codebook_data$
```


Create codebook

```{r codebook, message=FALSE, warning=FALSE}
codebook(df_Basic,metadata_table = FALSE, metadata_json = FALSE)
codebook(df_Belief,metadata_table = FALSE, metadata_json = FALSE)
codebook(df_self_eval,metadata_table = FALSE, metadata_json = FALSE)
codebook(df_Post,metadata_table = FALSE, metadata_json = FALSE)
codebook(df_knowledge,metadata_table = FALSE, metadata_json = FALSE)
codebook(df_Exit,metadata_table = FALSE, metadata_json = FALSE)
```
